\documentclass[11pt,reqno]{article}

\usepackage{graphicx}
\usepackage{tikz}
\usepackage{amsmath} 
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{units}   
\usepackage{float}   
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage[colorlinks]{hyperref}
\usepackage{framed}
\usepackage{url}

\floatstyle{ruled}
\newfloat{program}{thp}{lop}
%-------------------------------------------
\newcommand{\sign}{\ensuremath{\mathrm{sign}}}
\newcommand{\diag}{\ensuremath{\mathrm{diag}}}
\newcommand{\trace}[1]{\ensuremath{\mathrm{trace}\left( #1 \right)}}
\newcommand{\norm}[1]{\ensuremath{\left\|#1\right\|_2^2}}
\newcommand{\func}[2]{\ensuremath{\mathrm{#1}\left( #2 \right)}}
\newcommand\eps \epsilon
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\real}{\ensuremath{\mathbb{R}}}
\newcommand{\cl}[1]{\ensuremath{\mathcal{#1}}}
\newcommand{\suppsize}[1]{\ensuremath{|\mathcal{#1}|}}
\newcommand{\vect}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\matr}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\deriv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\arr}[2]{\begin{array}{#1}#2\end{array}}
\newcommand{\mat}[2]{\left(\begin{array}{#1}#2\end{array}\right)}
\newcommand{\brc}[2]{\left\{\begin{array}{#1}#2\end{array}\right.}
\newcommand{\pars}[1]{\left(#1\right)}
\newcommand{\brcs}[1]{\left\{#1\right\}}
\newcommand{\half}{\frac{1}{2}}

% Bold symbols and operators
\newcommand\Laplacian{\nabla^2}
\newcommand\bnabla{\boldsymbol{\nabla}}
\newcommand\bLaplacian{\boldsymbol{\nabla}^2}
\newcommand\bcdot{\boldsymbol{\cdot}}
\newcommand\bU{\mathscr{\boldsymbol{U}}}
\newcommand\bv{\boldsymbol{v}}
\newcommand\bV{\boldsymbol{V}}
\newcommand\bE{\boldsymbol{E}}
\newcommand\be{\boldsymbol{\hat{e}}}
\newcommand\bn{\boldsymbol{\hat{n}}}
\newcommand\bk{\boldsymbol{\hat{k}}}
\newcommand\bj{\boldsymbol{j}}
\newcommand\bi{\boldsymbol{i}}
\newcommand\bs{\boldsymbol{s}}
\newcommand\bA{\boldsymbol{A}}
\newcommand\bF{\boldsymbol{F}}
\newcommand\bG{\boldsymbol{G}}
\newcommand\bI{\boldsymbol{I}}
\newcommand\bJ{\boldsymbol{J}}
\newcommand\bx{\boldsymbol{x}}
\newcommand\by{\boldsymbol{y}}
\newcommand\bz{\boldsymbol{z}}
\newcommand\br{\boldsymbol{r}}
\newcommand\bc{\boldsymbol{c}}
\newcommand\bxhat{\hat{\bx}}
\newcommand\byhat{\hat{\by}}
\newcommand\bzhat{\hat{\bz}}
\newcommand\brhat{\hat{\br}}
\newcommand\bnhat{\hat{\boldsymbol{n}}}
\newcommand\btheta{\boldsymbol{\theta}}
\newcommand\bthetahat{\hat{\btheta}}
\newcommand\bphi{\boldsymbol{\phi}}
\newcommand\bphihat{\hat{\bphi}}
\newcommand\bzero{\boldsymbol{0}}
\newcommand\bomega{\boldsymbol{\omega}}
\newcommand\bpsi{\boldsymbol{\psi}}

% Calligraphic symbols
\newcommand\cB{\mathcal{B}}
\newcommand\cE{\mathcal{E}}
\newcommand\cF{\mathcal{F}}
\newcommand\cO{\mathcal{O}}
\newcommand\cG{\mathcal{G}}
\newcommand\cI{\mathcal{I}}
\newcommand\cP{\mathcal{P}}
\newcommand\cD{\mathcal{D}}
\newcommand\cL{\mathcal{L}}
\newcommand\cU{\mathscr{U}}
\newcommand\cV{\mathscr{V}}
\newcommand\cW{\mathscr{W}}

% Tensors
\newcommand\tI{\mathsf{I}}
\newcommand\tS{\mathsf{S}}
\newcommand\tT{\mathsf{T}}

% Unit vector
\newcommand\ui{\boldsymbol{\hat{\imath}}}

\setlength{\textheight}{8.7in}
\setlength{\columnsep}{2.0pc}
\setlength{\textwidth}{6.6in}
% \setlength{\footheight}{0.2in}
\setlength{\topmargin}{0.05in}
\setlength{\headheight}{0.2in}
\setlength{\headsep}{0.1in}
\setlength{\evensidemargin}{0in}
\setlength{\oddsidemargin}{0in}
% \setlength{\parindent}{1pc}
\setlength{\parindent}{0.0 in}
\setlength{\parskip}{0.1 in}

\title{Asymptotic and Numerical Solution for Electrokinetic Flow Around a Spherical Particle}
\author{Roman Zeyde \\ \\  {Advisor: Prof. Irad Yavneh} } \date{}

%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%

\maketitle

\begin{abstract}
A numerical framework for the simulation of electrokinetic 
migration of particles in an electrolyte solution 
due to the application of an external electric field is presented.
The electrokinetic transport process is
described by a system of nonlinear partial differential equations (PDE).
A thin boundary layer forms around the particle due to strong electrostatic forces. The resulting
scale disparity of the boundary layer
is used to derive nonlinear effective boundary conditions for the
numerical solver
using the specific chemical properties of the particle.
The nonlinear system is discretized and an iterative Newton solver is
constructed automatically from the discrete equations and boundary 
conditions.
An asymptotic analytical solution is 
derived for the validation of the solver. 
Numerical results are obtained for an ion-exchanger and 
for a surface charged inert particle. The numerical results 
are compared to the asymptotic solutions, and good correspondence is achieved.
\end{abstract}

\newpage
\tableofcontents
\newpage

\section{Introduction} \label{sec:intro}

Electrokinetic theory describes the dynamics of charged particles
in ionic fluids \cite{masliyah2005book,kirby2010book}.
When a particle acquires surface charge, a layer
of ions of opposite charge is attracted to the surface via    
electric forces, creating a double-layer structure around the
particle (see Figure \ref{fig:EDL}). This structure, called
``Debye layer'', electrically screens the surface charge,
creating a potential difference between the particle and the outer
layer of the fluid bulk.
In cases where the layer width is much smaller than the particle
size, an analytical asymptotic solution for the Debye layer
dynamics can be derived \cite{yariv2010asymptotic}.
\begin{figure}[htbp]
    \begin{center}
        \includegraphics[width=0.35\textwidth]
            {figs/debye.eps}
        \caption{Schematic structure of the double layer:
        (1) charged particle surface, (2) Debye layer, (3) fluid bulk.
        If the particle surface has positive (black) surface charge,
        it attracts negative (white) ions from the fluid making the
        Debye layer negatively charged (as opposed to the rest of
        the fluid bulk, which is electrically neutral).
        The zeta potential is defined as the voltage drop across 
        the Debye layer (2).}
        \label{fig:EDL}
    \end{center}
\end{figure}
% \begin{tikzpicture}\end{tikzpicture}

The variables of the electrokinetic flow equations are the electrostatic
potential $\varphi$, fluid velocity $\bv$ and its pressure $p$, and
ionic concentration $c$.
The boundary conditions are determined by the specific
problem under consideration and defined by the particle's
geometry, chemical characteristics, and the fluid dynamics.
The partial differential equations that describe the system dynamics
under an external electric field, are coupled and nonlinear, and
in general they have no analytic solution. 
Moreover, any numerical solver must handle the scale disparity caused by the
Debye layer width being much smaller than the particle size. 
A closed-form linear asymptotic solution has been developed for
spherical particles and weak electric field in an
axisymmetric setting \cite{yariv2010migration} but it is hard to extend this
analytic solution to more general systems. Once the electric field
becomes stronger, significant nonlinear phenomena emerge.
This interesting regime has not yet been explored extensively.
Recently, it has been conceived that such type of dynamics
can be very useful in transporting and manipulating micro-
and nanoscale objects in many nanotechnology applications,
nano-fluidic devices, packed bed separation, desalination processes and various 
electrophoresis applications \cite{howse2007self,paxton2004catalytic,pumera2010electrochemically,nischang2007,leinweber2004}.
Because the model for these electrokinetic
phenomena has no closed-form analytic solution, a numerical
solver for this system is of importance.

The goal of this work is to develop and implement a software toolbox for the generation
of iterative numerical solvers for nonlinear electrokinetic problems, and to apply it to the study
of systems that have no closed-form solutions, such as ion-exchanger migration
\cite{yariv2010migration} and the electrophoresis problem \cite{schnitzer2012surface}.
This solver can be used to gain insight into the chemical and physical behavior 
in far more general regimes than are currently well-understood, 
and also to possibly lead to further analytical developments, based on new scaling behavior
discovered numerically. We may also target interesting physical
phenomena that have been observed experimentally.
One such phenomenon is nonlinear electrokinetic vortex flow, 
which is useful for microfluidic mixing applications \cite{wang2004mix, ben2002vortex},

The paper is structured as follows: the governing equations of the electrokinetic model
are derived in Section \ref{sec:equations}. The algorithm for the discretization and 
the solution of the system is described in Section \ref{sec:algorithm}.
An analytical asymptotic solution for the nonlinear system is derived 
and presented in Section \ref{sec:asymp}.
Numerical results and their comparison to an analytical asymptotic solution 
are presented Section \ref{sec:results} and discussed in Section \ref{sec:discussion}. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Governing Equations} \label{sec:equations}

\subsection{Nondimensionalization}
Spatial coordinates $\br$ are normalized by $a^*$ 
(the characteristic size of the particle).
Positive and negative ionic concentrations are denoted by $c_+$ and $c_-$, respectively, and
are normalized by the ambient ionic concentration $c^*$. The ionic valences are $\pm z$.
The dimensional ionic fluxes, $\bj_\pm$, are given by the Nernst-Plank equation 
(using the Einstein relation for the electric mobility, $\mu_q^* = D^* / k_B^* T^*$, 
where $D^*$ is the ionic diffusivity):
\begin{equation}
\bj^*_\pm = 
-D^* \bnabla c^*_\pm + \bv^* c^*_\pm \mp \frac{z e^* D^*}{k_B^* T^*} c^*_\pm \bnabla \varphi^*,
\end{equation}

The electric potential $\varphi$ is normalized by the thermal voltage:
$\varphi^* = {k_B^* T^*}/{z e^*} = {R^* T^*}/{z F^*},$
where $R^* = k_B^* N_A$, $F^* = e^* N_A$ is the Faraday number and $N_A$ is the Avogadro constant.

The dimensional Stokes equations with electrostatic forces are given by:
\begin{equation} \begin{array}{cc}
\bnabla \cdot \bv = 0, &
-\bnabla p^* + \mu^* \bLaplacian \bv^* + \eps^* \Laplacian \varphi^* 
\bnabla \varphi^* = 0.
\end{array}\end{equation}

The velocity $\bv$ is normalized by $v^* = {\eps^* (\varphi^*)^2}/{a^* \mu^*}$,
and the pressure $p$ is normalized by $p^* = {\mu^* v^*}/{a^*} = {\eps^* (\varphi^*)^2}/{(a^*)^2}$.
The fluxes $\bj^*_\pm$ are normalized by $j^* = {D^* c^*}/{a^*}$.

The dimensional Poisson equation can be written as
\begin{equation}
(c^*_+ - c^*_-) z e^* = -\eps^* \Laplacian \varphi^*,
\end{equation}

After nondimensionalization, the Nernst-Plank, Stokes and Poisson equations read:
\begin{equation} \label{eq:nernst}
\bj_\pm = 
-\bnabla c_\pm + \alpha \bv c_\pm \mp c_\pm \bnabla \varphi,
\end{equation}
\begin{equation} \label{eq:stokes}
\begin{array}{cc}
\bnabla \cdot \bv = 0, &
-\bnabla p + \bLaplacian \bv + \Laplacian \varphi \bnabla \varphi = 0, 
\end{array}
\end{equation}
\begin{equation} \label{eq:poisson}
c_+ - c_- = -2\delta^2 \Laplacian \varphi,
\end{equation}
where $\delta = {\delta^*}/{a^*}$ is the dimensionless Debye thickness 
($\delta^* = \sqrt{{\eps^* \varphi^*}/{2 c^* e^* z}}$) and 
$\alpha = {v^* a^*}/{D^*} = {\eps^* (\varphi^*)^2}/{\mu^* D^*}$ 
is the dimensionless Peclet number.
The force on the particle is denoted by $\bF$ normalized by $\mu^* v^* a^* = \eps^* (\varphi^*)^2$.
The stress tensor is denoted by $\tT$ and normalized by $p^* = \mu^* v^* / a^*$.
The electric field is denoted by $\bE$ and normalized by $E^* = \varphi^* / a^*$.
The surface charge is denoted by $\sigma$ and normalized by $\sigma^* = \eps^* \varphi^* / \delta^*$.

The ionic fluxes are given by ion diffusion, electrostatic forces and ion advection by the fluid
in \eqref{eq:nernst}. Due to conservation of ion concentrations, the fluxes are divergence-free:
\begin{equation*}
\bnabla \cdot \bj_\pm = 0.
\end{equation*}
These equations may be re-written by using salt $c = (c_+ + c_-)/2$ and charge $q = (c_+ - c_-)/2$.
Thus, salt and charge fluxes are defined by:
\begin{equation}\label{eq:fluxes}\begin{array}{cc}
  \bj = \frac{\bj_+ + \bj_-}{2} = -\bnabla c - q \bnabla \varphi + \alpha \bv c, & 
  \bi = \frac{\bj_+ - \bj_-}{2} = -\bnabla q - c \bnabla \varphi + \alpha \bv q,
\end{array}\end{equation}
and are divergence-free as well:
\begin{equation}\label{eq:zero_flux}\begin{array}{cc}
\bnabla \cdot \bj = 0, & 
\bnabla \cdot \bi = 0. 
\end{array}\end{equation}
In addition, the charge concentration is governed by the Poisson equation \eqref{eq:poisson}
\begin{equation}
q = -\delta^2 \Laplacian \varphi.
\end{equation}

\subsection{Boundary conditions}
We assume that a constant electric field of nondimensional magnitude $\beta$,
is applied to the system, in the direction denoted by the unit vector $\ui$.
As a result, the particle will equilibrate at 
a non-zero steady-state velocity $\cU \ui$, which is
a function of the applied field, and is not known a priori.

We employ the reference frame of the particle.
Far away from the particle, we have a uniform applied electrostatic field, uniform flow,
and ambient ionic concentrations:
\begin{equation}\label{eq:bndcond_inf}\begin{array}{ccc}
\bv \rightarrow -\cU \ui, &
\bnabla \varphi \rightarrow -\beta\ui, &
 c_\pm \rightarrow 1.
\end{array}\end{equation}

We consider a spherical particle.
The chemical properties of the particle's surface $\mathcal{S}$ (defined at $r=1$ 
with normal $\bn = \brhat$), determine the boundary conditions on $\mathcal{S}$.
We consider the following scenarios:
\subsubsection{Ion-exchanger \cite{yariv2010migration}}
We assume high conductance of the particle (yielding a uniform electric potential),
zero slip, anion impermeability, cation selectivity 
(with fast Butler-Volmer\cite{bard2000book} kinetics
$\bn \cdot \bj_+ = k (1 - c_+/\gamma)$, where $k \rightarrow \infty$):
\begin{equation}
\begin{array}{cccc}
\varphi = \cV, &
\bv = \bzero, &
\bn \cdot \bj_- = 0, &
c_+ = \gamma,
\end{array}
\end{equation}
where $\gamma$ is the ratio between the cationic concentration on the surface and the cationic
concentration in the fluid bulk and $\cV$ is an unknown constant electric potential at
the ion-exchanger surface. 

\subsubsection{Inert particle \cite{schnitzer2012surface}}
We assume constant surface charge
zero slip and ion impermeability:
\begin{equation}
\begin{array}{cccc}
\bn \cdot (\bnabla \varphi - \chi \bnabla \varphi_s) = \delta^{-1} \sigma, &
\bv = \bzero, &
\bn \cdot \bj_\pm = 0,
\end{array}
\end{equation}
where $\chi$ is the ratio between the dielectric constants of the 
particle and the fluid.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Separation of scales}
When $\delta \ll 1$, 
the fluid remains electroneutral ($q \approx 0$, thus $c_+ \approx c_-$), 
except inside a thin boundary layer of width $O(\delta)$ 
surrounding the particle (the ``Debye layer'').
This boundary layer makes it very hard to construct 
a direct numerical solver for the full electrokinetic problem.
However, we exploit the scale disparity at the Debye layer, 
which allows the PDE system to be rewritten in the ``inner'' region 
as an ODE system using the asymptotic limit of $\delta \rightarrow 0$.
This system can be integrated and solved analytically,
yielding ``effective'' boundary conditions near
the particle surface for the ``outer'' bulk region equations.

\subsubsection  {Bulk-scale equations}
The Nernst-Planck equations above \eqref{eq:fluxes} for the fluid bulk outside
the boundary layer, using bulk variables denoted by uppercase letters, read:
\begin{equation} \begin{array}{cccc} \label{eq:bulk_flux}
  Q = 0, &
  C = C_+ = C_-, &
\bJ = -\bnabla C + \alpha \bV C, &
\bI = -C \bnabla \varPhi.
\end{array}\end{equation}
Because the flow is incompressible ($\bnabla \cdot V = 0$), 
ion conservation results in the following 
salt and charge conservation equations -- the salt and charge fluxes above 
\eqref{eq:bulk_flux} are divergence-free
\eqref{eq:zero_flux}:
\begin{equation} \begin{array}{ccc}
\label{eq:salt_charge}
\Laplacian C - \alpha \bV \cdot \bnabla C = 0, &
\bnabla \cdot \pars{ C \bnabla \varPhi } = 0.
\end{array}\end{equation}
The macroscale Stokes flow equations have the same form as before \eqref{eq:stokes}:
\begin{equation}
\begin{array}{ccc}
\bnabla \cdot \bV = 0, &   
\Laplacian \bV - \bnabla P + \bnabla \varPhi \Laplacian \varPhi = \bzero.
\end{array}
\end{equation}

\subsection{Bulk-scale effective boundary conditions}
By integrating the equations across the Debye layer,
the effective boundary conditions at the particle surface are:
\subsubsection{Ion-exchanger} See Appendix \ref{append:slip} for full derivation:
\begin{equation}
\begin{array}{ccc}
\label{eq:ionex_bnd}
0 = \varPhi + \log C, &
0 = \deriv{}{n} \pars{\varPhi - \log C}, &
\bV = 
\zeta \cdot \bnabla_\mathcal{S} \varPhi 
+ 2\log\pars{1-\tanh^2\frac{\zeta}{4}} \cdot \bnabla_\mathcal{S} \log C,
\end{array}\end{equation}
where $\zeta = \cV - \varPhi = \log (C / \gamma)$ 
is the zeta potential.

\subsubsection{Highly charged inert particle}
See \cite{schnitzer2012surface} for full derivation:
\begin{equation} \label{eq:ephor_bnd}
\begin{array}{ccc}
0 = {\deriv{C}{n} - \text{Du} \nabla^2_s \pars{\varPhi - \log C}}, & 
0 = {\deriv{C}{n} + C \deriv{\varPhi}{n}}, &
\bV = \zeta \cdot \bnabla_\mathcal{S} \pars{\varPhi - \log C} +
4 \log 2 \cdot \bnabla_\mathcal{S} \log C,
\end{array}\end{equation}
where $\zeta = \bar{\zeta} - \log C$ 
is the zeta potential and $\bar{\zeta} = 2 \log \sigma$.

\subsection{Steady state}
The stress tensor in the fluid is composed of Newtonian and Maxwel stresses:
\begin{equation}
\label{eq:tensor}
\tT = \bnabla \bV + (\bnabla \bV)^\dagger - P \tI
+ \bnabla \varPhi \bnabla \varPhi - \frac{1}{2} (\bnabla \varPhi \cdot \bnabla \varPhi). 
\end{equation} 
In steady state (constant particle drift velocity $\cU$), the total force acting on the particle 
(computed by the following surface integral) must vanish:
\begin{equation} \label{eq:zero_force}
 \bF(\beta, \cU) = \oint_\mathcal{S} \tT \cdot \bnhat dA = \bzero.
\end{equation}

The total force $\bF(\beta, \cU)$ is a function of the applied electric field $\beta$ and
the velocity $\cU$.
For any given electric field $\beta$, the force-free constraint above 
can be solved numerically for $\cU$ to yield the corresponding steady-state velocity.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Algorithm Description} \label{sec:algorithm}
The numerical solver first requires constructing a discrete 
approximation for the nonlinear PDE system,
for a given electric field $\beta$ and assumed velocity $\cU$. 
The resulting nonlinear discrete system is
solved numerically using Newton's Method, so the total force on the
particle can be computed. 
We seek the steady-state velocity $\cU$, 
which corresponds to zero total force, $F(\beta, \cU) = 0$,
which we solve by the standard secant method.

\subsection{Spherical Coordinates}
Because the system is axisymmetric, we employ
spherical coordinates $(r,\theta,\phi)$.
The scalar gradient and the divergence can be written as:
\begin{align}
\bnabla f = \deriv{f}{r}\brhat + \frac{1}{r}\deriv{f}{\theta}\bthetahat, &
\bnabla \cdot \bF = \frac{1}{r^2}\deriv{}{r}\pars{F_r r^2 } + 
               \frac{1}{r \sin\theta}\deriv{}{\theta}\pars{F_\theta \sin\theta}.
\end{align}
The scalar Laplacian can be written as:
\begin{align}
\Laplacian f = \bnabla \cdot (\bnabla f) = 
 \frac{1}{r^2}\deriv{}{r}\pars{r^2 \deriv{f}{r}} + 
 \frac{1}{r^2 \sin\theta}\deriv{}{\theta}\pars{\sin\theta \deriv{f}{\theta}}.
\end{align}
The vector gradient and vector Laplacian can be written as:
\begin{align}
\bnabla \bF &= \deriv{F_r}{r} \brhat \brhat + \deriv{F_\theta}{r} \brhat \bthetahat + 
\frac{1}{r}\pars{\deriv{F_r}{\theta} - F_\theta} \bthetahat \brhat + 
\frac{1}{r}\pars{\deriv{F_\theta}{\theta} + F_r} \bthetahat \bthetahat, \\
\bLaplacian \bF &= 
\left(\Laplacian F_r - \frac{2F_r}{r^2} - 
\frac{2}{r^2 \sin\theta} \deriv{\left(F_\theta \sin\theta \right)}{\theta}\right)\brhat
+ \left(\Laplacian F_\theta - \frac{F_\theta}{r^2 \sin^2\theta} + 
\frac{2}{r^2}\deriv{F_r}{\theta}\right) \bthetahat.
\end{align}

Note that in the spherical coordinate system,
the vector Laplacian operator cannot be computed in a decoupled manner as in the Cartesian system,
since the unit vectors $\brhat, \bthetahat, \bphihat$ are functions of the coordinates
in a curvilinear coordinate system. 
See Appendix \ref{append:spherical} for the full derivation of the identities above.

\subsection{Computational Grid}
A regular grid of size $n_r \times n_\theta$ is defined, with:
\begin{align} \label{eq:grid}
(r_i,\theta_j) \in [1, \infty) \times [0,\pi], & 
r_i = (1+\Delta_r)^i, &
 \theta_j = \Delta_\theta \cdot j,
\end{align}
where a logarithmic grid spacing has been chosen for $r$ and a uniform grid for $\theta$.
Note that $r_0 = 1$ and $R_{max} = (1+\Delta_r)^{n_r}$, where
$\Delta_r = \pars{R_{max}} ^ {1/n_r} - 1$ and $\Delta_\theta = {\pi/n_\theta}$.
Because the grid is finite, the choice 
$R_{max}$ must be taken large enough so as to have a negligible effect
on the solution.
This grid induces a disjoint subdivision of the domain 
$\Omega = [1, R_{max}] \times [0,\pi] = \bigcup_{ij}\Omega_{ij}$ into cells.
A specific cell $\Omega_{ij}$ and its center $(\bar{r}_i, \bar{\theta}_j)$ are defined by \eqref{eq:grid}:
\begin{align}
\Omega_{ij} = [r_{i-1}, r_{i}] \times [\theta_{j-1}, \theta_{j}], &
\bar{r}_i = (r_{i-1} + r_{i})/2, &
\bar{\theta}_j = (\theta_{j-1} + \theta_{j})/2.
\end{align}

Each discrete variable is located with respect of its cell as follows:
$\varPhi$, $C$ and $P$ are represented by their value at the center of each cell, 
using an all-centered grid, whereas $\bV$ is represented by its values at cell 
boundaries, using a staggered grid:
\begin{equation}
\begin{array}{ccccc}
\varPhi^h_{[i,j]} = \varPhi(\bar{r}_i, \bar{\theta}_j), &
C^h_{[i,j]} = C(\bar{r}_i, \bar{\theta}_j), &
P^h_{[i,j]} = P(\bar{r}_i, \bar{\theta}_j). &
V_r^h{}_{[i,j]} = V_r(r_i, \bar{\theta}_j), &
V_\theta^h{}_{[i,j]} = V_\theta(\bar{r}_i, {\theta}_j).
\end{array}
\end{equation}

\subsection{Operator Discretization} 
A finite-volume method with linear interpolation is used for flux discretization. 
Define the following discrete central difference operators:
\begin{align} \label{eq:disc_diff}
\cD_r(f^h){}_{\left[i+\half,j\right]} = \frac{f^h_{\left[i+1,j\right]} - f^h_{\left[i,j\right]}}
                       {r_{\left[i+1,j\right]} - r_{\left[i,j\right]}}, &
\cD_\theta(f^h){}_{\left[i,j+\half\right]} = \frac{f^h_{\left[i,j+1\right]} - f^h_{\left[i,j\right]}}
					   {\theta_{\left[i,j+1\right]} - \theta_{\left[i,j\right]}}.
\end{align}

Define the following linear interpolation operators:
\begin{align} \label{eq:disc_interp}
\begin{array}{rcl}
\cI_r(f^h)_{\left[i+\half,j\right]} &= 
\frac{r_{\left[i+\half,j\right]} - r_{\left[i,j\right]}}
{r_{\left[i+1,j\right]} - r_{\left[i,j\right]}} 
f^h_{\left[i+1,j\right]} 
+ 
\frac{r_{\left[i+1,j\right]} - r_{\left[i+\half,j\right]}}
{r_{\left[i+1,j\right]} - r_{\left[i,j\right]}}
f^h_{\left[i,j\right]},
\\
\cI_\theta(f^h)_{\left[i,j+\half\right]} &= 
\frac{r_{\left[i,j+\half\right]} - r_{\left[i,j\right]}}
{r_{\left[i,j+1\right]} - r_{\left[i,j\right]}}
  f^h_{\left[i,j+1\right]} + 
\frac{ r_{\left[i,j+1\right]} - r_{\left[i,j+\half\right]}}
{r_{\left[i,j+1\right]} - r_{\left[i,j\right]}}
  f^h_{\left[i,j\right]}.
\end{array}
\end{align}

If the total flux of a cell is equal to zero ($\bnabla \cdot \boldsymbol{f} = 0$), 
then using \eqref{eq:disc_diff}, we have
\begin{align}
\frac{1}{r^2} \cD_r\pars{f^h_r r^2} + 
\frac{1}{r \sin\theta} \cD_\theta\pars{f^h_\theta \sin\theta} =
\frac{\cD_r\pars{f^h_r \cdot r^2 \sin\theta} + 
\cD_\theta\pars{f^h_\theta \cdot r \sin\theta}}{r^2 \sin\theta} = 0. 
\end{align}

\subsection{System Equations} \label{sec:disc_equations}
Charge and salt fluxes \eqref{eq:bulk_flux} are discretized on grid cell boundaries 
(using an upwind scheme $\mathcal{U}$ for numerical stability at large cell Peclet number)  
using \eqref{eq:disc_diff} and \eqref{eq:disc_interp}:
\begin{align} \nonumber
I^h_r = -\cI_r(C^h) \cdot \cD_r(\varPhi^h), &
I^h_\theta = -\cI_\theta(C^h) \cdot \frac{\cD_\theta(\varPhi^h)}{r}, \\
J^h_r = -\cD_r(C^h) + \alpha V^h_r \cdot \mathcal{U}^{\bV^h}_r (C^h), &
J^h_\theta = -\frac{\cD_\theta(C^h)}{r} + \alpha V^h_\theta \cdot \mathcal{U}^{\bV^h}_\theta (C^h), 
\\ \nonumber
 \mathcal{U}^{\bV^h}_r(C^h)[i,j] = C^h\left[i-\frac{\sign(V^h_r)}{2}, j\right], &
 \mathcal{U}^{\bV^h}_\theta(C^h)[i,j] = C^h\left[i, j-\frac{\sign(V^h_\theta)}{2}\right]. 
\end{align}

Mass flux $\bV$ is discretized on grid cells boundaries, 
using the staggered velocity grid.

Force components ($\bF = -\bnabla P + \bLaplacian \bV + \bnabla \varPhi \Laplacian \varPhi$) 
are discretized on the staggered velocity grid, where
linear interpolation is used for the Coulomb force and for vector Laplacian components.
\begin{align}
\nonumber
F^h_r &= -\cD_r(P^h) 
          + \cL(V^h_r) - \frac{2}{r^2} V^h_r 
		  - \frac{2}{r^2 \sin\theta} \cI_r(\cD_\theta (V^h_\theta \sin\theta))
          + \cD_r(\varPhi^h) \cdot \cI_r(\cL(\varPhi^h)), \\
F^h_\theta &= -\frac{\cD_\theta(P^h)}{r} 
		  + \cL(V^h_\theta) - \frac{F^h_\theta}{r^2 \sin^2\theta} 
		  + \frac{2}{r^2} \cI_\theta(\cD_\theta(F^h_r))
		  + \frac{\cD_\theta(\varPhi^h)}{r} \cdot \cI_\theta(\cL(\varPhi^h)), \\
\nonumber
\cL(f^h) &= \frac{1}{r^2}\cD_r\pars{\cD_r(f^h) r^2} + 
\frac{1}{r^2 \sin\theta} \cD_\theta\pars{\cD_\theta(f^h) \cdot \sin\theta}.
\end{align}


\subsection{Boundary Conditions} \label{sec:disc_boundary}
In order to discretize boundary condtions for $\varPhi$, $C$ and $\bV$, 
``ghost'' points are employed. 
The grid is extended to include points outside the domain interior,
and the variables at the ``ghost'' points are set to satisfy 
the discretized boundary conditions, following the analysis below.
Note that $P$ has no boundary conditions -- so the pressure variable is defined 
only in the domain interior.

Far away from the particle boundary \eqref{eq:bndcond_inf}, we have:
\begin{equation}
\begin{array}{cccc}
\cD_r \pars{\varPhi^h} = -\beta \cos\bar{\theta}, &
\cI_r \pars{C^h} = 1 &
V_r^h = -\cU \cos\theta, &
V_\theta^h = \cU \sin\theta.
\end{array}\end{equation}

For $\theta = 0$ and $\theta = \pi$, the ``ghost'' points are defined by axial 
symmetry considerations:
\begin{equation} 
\begin{array}{cccc}
\cD_\theta \pars{\varPhi^h} = 0, &
\cD_\theta \pars{C^h} = 0, &
\cD_\theta \pars{V_r^h} = 0, &
V_\theta^h = 0
\end{array}
\end{equation}


The specific boundary conditions at $r=1$
depend on the chemical properties of particle surface.

\subsubsection{Ion-exchanger} The boundary conditions \eqref{eq:ionex_bnd} 
are implemented by:
\begin{equation}
\begin{array}{rcl}
0 &= \cI_r(\varPhi^h + \log C^h), \\
0 &= \cD_r(\varPhi^h - \log C^h), \\
V^h_r &= 0, \\
V^h_\theta &= 4\log\pars{\frac{1}{2}\pars{1 + \exp\left\{\cI_\theta(\zeta^h)/2\right\}}} \cdot 
			\cD_\theta(\zeta^h), \\
  \zeta^h &= - \log \gamma - \cI_r(\varPhi^h).
\end{array}
\end{equation}

\subsubsection{Highly charged inert particle} The boundary conditions \eqref{eq:ephor_bnd} 
are implemented by:
\begin{equation}
\begin{array}{rcl}
0 &= \cD_r(C^h) - \text{Du} \cdot 
\pars{\cD_\theta \pars{\sin\theta \cdot \cD_\theta \cI_r\pars{\varPhi^h - \log C}}}/{\sin\theta}, \\
0 &= \cD_r(C^h) + \cI_r(C^h) \cD_r(\varPhi^h), \\
V^h_r &= 0, \\
V^h_\theta &= \cI_\theta(\zeta^h) \cdot \cD_\theta(\cI_r \varPhi^h - \log \cI_r C^h) + 
4 \log 2 \cdot \cD_\theta(\log \cI_r C^h), \\
  \zeta^h &= \bar{\zeta} - \log \cI_r C.
\end{array}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Solver Design}
An operator $\cO$ is defined by its input vector $\bx$ and its output 
$\by = \cO(\bx)$.
In order to solve the equation $\cO(\bx) = \bzero$, Newton's method is applied, 
given an initial solution $\bx_0$.
Each step requires the computation of the residual vector, $\br = \cO(\bx)$, and
the gradient matrix of the operator, $\bG = \bnabla \cO(\bx)$, 
given the current solution $\bx$.
Then, a sparse linear system $\bG \Delta \bx = \br$
needs to be solved to yield the update $\Delta \bx$.
When the method converges, $\bx_n \rightarrow \bx_\infty$, 
the asymptotic convergence is in general quadratic:
\begin{equation}
\|\bx_{n+1} - \bx_\infty\| \le k \|\bx_{n} - \bx_\infty\|^2.
\end{equation}
Thus, when the initial guess is close enough to the solution, the solver
will typically converge in very few steps.

\subsubsection{Operator Representation}
System variable $\bx$ is defined as the concatenation $\bx = [\,\varPhi, C, V_r, V_\theta, P\,]$.
Thus, each problem variable can be computed by applying an appropriate projection operator on $\bx$.
The system can be written as a nonlinear operator $\cO(\bx) = \bzero$ 
acting on the system variable ${\bx}$, 
where $\cO$ is the system equations operator, 
derived by concatenation of the system equations (described in Subsection \ref{sec:disc_equations})
and the boundary conditions operators (described in Subsection \ref{sec:disc_boundary}).
This way, the same numerical solver handles both the nonlinear system equation and nonlinear
boundary conditions.

\subsubsection{Steady-state}
Let $\beta$ be a given nondimensional electric field.
Assume that $\cU \ui$ is the drift velocity of the particle 
(given that the fluid is at rest far away from it).
After the convergence of the solver, once the residual norm is below
a prescribed threshold $\|\cO(\bx_n)\| < \epsilon$, 
the total force acting on the particle  
can be computed by integrating $\tT \cdot \bn$ over the particle surface.

Due to symmetry considerations, the total force $\bF$ is 
aligned with $\ui$ and it vanishes iff $\ui \cdot \bF = 0$.
\begin{align} \nonumber
F_\imath = \ui \cdot \bF &= 
\oint_\mathcal{S} \pars{\ui \cdot \tT \cdot \bnhat} dA = 
\int_0^\pi f_\imath(\theta) 2\pi \sin\theta d\theta ,
\\  
f_\imath = \ui \cdot \tT \cdot \brhat &= \pars{-P + 2\cD_r(V_r) + 
\frac{1}{2}\pars{\cD_r(\varPhi)}^2 - \frac{1}{2r^2}\pars{\cD_\theta(\varPhi)}^2}\cos\theta 
\\  \nonumber
&& -\pars{\cD_r(V_\theta) - \frac{V_\theta}{r}
+ \frac{1}{r}\cD_r(\varPhi) \cD_{\theta}(\varPhi)}\sin\theta.
\end{align}

The integral above is approximated by 1D numerical quadrature
(using the mid-point rule)
\begin{equation}
F_\imath^h(\beta, \cU^h) = \sum_{i=1}^{n_\theta} f^h(\bar\theta_i) \cdot 
              2 \pi \sin\bar\theta_i \cdot \Delta\theta_i,
\end{equation}
to yield the total force $F_\imath^h(\beta, \cU^h)$ as a function of the drift velocity $\cU^h$.
Since the goal is to find the steady-state solution, $F_\imath^h$ 
is required to be zero --
and the appropriate $\cU^h$ is found by a simple 1D root-finding algorithm,
applied as an outer loop:
\begin{equation} \label{eq:disc_zero_force}
F_\imath^h(\beta, \cU^h(\beta)) = 0
\end{equation}

\subsubsection{Continuation}

The iterative solver above can in principle be used 
to compute the steady-state solution for any given $\beta$.
For $\beta \ll 1$, the linear terms are the dominant ones, 
so the solution is approximately linear in $\beta$ 
(as derived in \cite{yariv2010migration}), and the solver convergence is fast.
However, this is no longer true for $\beta \gtrsim 1$, because the nonlinear terms become dominant
and the iterative solver may not converge at all if we start with an arbitrary initial guess.
In order to find a solution for such $\beta$, a continuation method is used:
the solver is applied to a sequence of $\{\beta_i\}_{i=0}^n$ such that $\beta_0 = 0$,
$\beta_n = \beta$ and the solution $\bx_i$ for $\beta_i$ is used as the solver initializer
for the problem of $\beta_{i+1}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Solver Implementation}

Object-Oriented Design methodology is used for implementation.
The MATLAB programming language is chosen due to strong numerical capabilities
and high-level language features.
The source code of the solver is provided in \cite{source}.

\subsubsection{Operator Interface}
The base \verb|Operator| interface is defined by 
supporting the computation of a residual vector \verb|Operator::res()|
and a gradient matrix \verb|Operator::grad()|, given an input vector $\bx$.
This interface is implemented by specific operators classes,
which are used to construct the system operator $\cO$, so that 
the Newton solver (that requires computing the residual and the gradient) 
can be applied automatically.
Each such operator may have other operators as its inputs, so the residual
and the gradient are computed recursively, using the chain rule (applied to operators).

\paragraph{\textit{Linear operator}}
If $\cO$ is linear, it can be represented by a matrix $L$, such that:
\begin{equation}\begin{array}{cc}
\cO(\bx) = L \bx, &
\bnabla\cO = L. 
\end{array}\end{equation}
Note that finite difference $\cD$, interpolation $\cI$ and 
upwind selection $\mathcal{U}$ operators
can be implemented as linear sparse operators, by constructing 
an appropriate sparse matrix $L$, having $O(\dim \bx)$ non-zeroes.
This way, the computation of the residual is very fast, taking $O(\dim \bx)$ time,
and the gradient does not depend on $\bx$.

\paragraph{\textit{Pointwise scalar function}}
Let $f: \R \rightarrow \R$ be a differentiable 1D function, whose derivative is
denoted by $f': \R \rightarrow \R$. The operator $\cF$ can be defined to
represent pointwise application of $f$:
\begin{equation}\begin{array}{cc}
\cF(\bx) = [f(x_1); \ldots; f(x_n)], &
\bnabla\cF(\bx) = \diag\{f'(x_1), \ldots, f'(x_n)\}.
\end{array}\end{equation}
$f$ is defined and differentiated automatically using the MATLAB symbolic toolbox.

\paragraph{\textit{Constant value}}
A constant operator $\mathcal{C}$ is defined by constant vector $\bc$ 
(that does not depend on $\bx$):
\begin{equation}\begin{array}{cc}
\mathcal{C}(\bx) = \bc, &
\bnabla\mathcal{C} = \bzero.
\end{array}\end{equation}

\paragraph{\textit{Binary operators}}
Let $\cO_1$ and $\cO_2$ be two operators, so their pointwise addition, subtraction,
and multiplication, are defined as follows:
\begin{equation}\begin{array}{cc}
(\cO_1 \pm \cO_2)(\bx) = \cO_1(\bx) \pm \cO_2(\bx), &
\bnabla (\cO_1 \pm \cO_2)(\bx) = \bnabla\cO_1(\bx) \pm \bnabla\cO_2(\bx),
\end{array}\end{equation}
\begin{equation}\begin{array}{cc}
(\cO_1 \cdot \cO_2)(\bx) = \cO_1(\bx) \cdot \cO_2(\bx), &
\bnabla (\cO_1 \cdot \cO_2)(\bx) = \diag(\cO_2(\bx)) \bnabla\cO_1(\bx) 
                                  + \diag(\cO_1(\bx)) \bnabla\cO_2(\bx).
\end{array}\end{equation}
\paragraph{\textit{N-ary operators}}
Given $N$ operators $\{\cO_i\}_{i=1}^N$, their concatenation $\cO$ is defined as:
\begin{equation}\begin{array}{cc}
\cO(\bx) = [\cO_1(\bx); \ldots; \cO_N(\bx)], &
(\bnabla\cO)(\bx) = [(\bnabla\cO_1)(\bx); \ldots; (\bnabla\cO_N)(\bx)].
\end{array}\end{equation}

\subsubsection{Handling the Singularity} \label{sec:singular}
The electric potential $\varPhi$ (in electrophoresis case) and the pressure $P$ (in both cases) 
are defined up to an additive constant, since the system equations and the boundary conditions
contain only their derivatives.
In order to overcome the singularity of the linear system 
$\bG \Delta\bx = -\br$, we set the variable at 
a specific grid point to be $0$.
In order to retain square system, we should remove one conservation equation at this grid point too.
In the case of pressure $P$, we remove one mass conservation equation,
$\bnabla \cdot \bV = 0$, at this grid point. 
In the case of electric potential, we remove the charge conservation
equation, $\bnabla \cdot \pars{C \bnabla \varPhi} = 0$, at this grid point.
For $\br = \cO(\bx)$ and $\bG = \bnabla \cO(\bx)$, the new square linear system reads:
\begin{equation}
\mathbb{R} \bG \mathbb{P} \cdot \delta\bx = -\mathbb{R} \br,
\end{equation}
where $\mathbb{P}$ matrix is used to remove the columns
and $\mathbb{R}$ matrix is used to remove the rows of $\bG$,
where the update step is $\Delta \bx = \mathbb{P} \cdot \delta \bx$.

\subsubsection{Iterative Newton solver}
Given an initial solution $\bx_0$ and prescribed values for $\beta$ and $\cU$, 
we apply the following algorithm 
until convergence ($\|\boldsymbol{r_n}\| < \eps$):
\begin{enumerate}
\item Update the system operator: $\verb|op| = \verb|System|(\bx_{n})$
\item Compute the gradient: $\boldsymbol{G}_n = \verb|op.grad()|$
\item Compute the right-hand side: $\boldsymbol{r}_n = \verb|op.res()|$
\item Solve sparse linear system: $\mathbb{R}\boldsymbol{G}_n \mathbb{P} \Delta \bx_n = -\mathbb{R}\boldsymbol{r}_n$
\item Update solution: $\bx_{n+1} = \bx_{n} + \mathbb{P}\Delta \bx_{n}$
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Asymptotic Analysis} \label{sec:asymp}
In order to validate the numerical results, an asymptotic analysis is applied 
to the nonlinear systems of ion-exchanger migration 
and highly charged particle electrophoresis.
We present here the asymptotic analysis for the ion-exchanger case \cite{yariv2010migration},
and the asymptotic analysis for the electrophoresis case \cite{schnitzer2012surface}
appears in \cite{schnitzer2012cubic}.

The derivation is performed as follows.
The nonlinear system (composed of the governing equations and the boundary conditions) 
is written as $\cO(\bx;\beta) = \bzero$.
For small $\beta$, the solution to the nonlinear system can be expanded in a Taylor series in $\beta$:
\begin{equation}
\bx = \bx(\beta) \approx \sum_n \bx_n \beta^n.
\end{equation}
The nonlinear terms
are expanded around $\beta = 0$:
\begin{equation}
\bzero = \cO(\bx) = \sum_i \cO_i(\bx_0, \ldots \bx_i) \beta^i.
\end{equation}

Thus, the $O(\beta^k)$ term $\bx_k$ can be found recursively by solving 
$\cO_k(\bx_0, \bx_1, \ldots, \bx_k) = \bzero$,
given the previous solutions for $\bx_0, \ldots, \bx_{k-1}$.
The derivation is validated using MATLAB symbolic toolbox by the code 
at \verb|symbolic/asymp.m| \cite{source}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{First-Order (linear in $\beta$) Solution} \label{app:linear}

For $\beta = 0$ (no electric field is applied), the steady-state solution is $\cU = 0$:
\begin{equation}\begin{array}{cccc}
\varPhi_0(r,\theta) = 0, &
C_0(r,\theta) = 1, &
\bV_0(r,\theta) = \bzero, &
P_0(r,\theta) = 0.
\end{array}\end{equation}

Assuming $\beta \ll 1$, the linearized equations and boundary conditions are
\begin{equation} \begin{array}{ccc}
\Laplacian \varPhi_1 = 0, &
\Laplacian C_1 = 0, &
\bLaplacian \bV_1 - \bnabla P_1 = \bzero.
\end{array}\end{equation}

The first-order terms $\bx_1$ are given by (see \cite{yariv2010migration} for full derivation)
\begin{equation} \begin{array}{cccc}
\varPhi_1 = \pars{\frac{1}{4r^2} - r}\cos\theta, &
C_1 = \frac{3}{4r^2} \cos\theta, &
\Psi_1 = \cU_1 \pars{\frac{1}{r} - r^2} \frac{\sin^2\theta}{2}, &
P_1 = 0,
\end{array} \end{equation}
and the linear velocity term is:
\begin{equation} \label{eq:linear_velocity}
\cU_1(\gamma) = 2 \log \pars{\frac{1 + \gamma^{-\frac{1}{2}}}{2}}.
\end{equation}
For $\gamma > 1$, the Debye layer has a positive space charge, 
corresponding to a negative particle charge -- 
yielding negative drift velocity, $\cU < 0$. 
For $\gamma < 1$, we have $\cU > 0$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Second-Order (quadratic in $\beta$) Solution} \label{app:quadratic}
The quadratic terms $\bx_2$ are computed by solving a linear PDE system 
with a right-hand side determined by the linear terms $\bx_1$, yielding
\begin{equation}
\varPhi_2 = \pars{\frac{\cU_1\, \alpha}{32} - \frac{1}{16}}
\frac{3\, {\cos^2\theta} - 1}{r^3} - \frac{3 + 3\, {\sin^2\theta}\, \left(4\, r^3 - 1\right)}{32\, r^4} - \frac{3\, \cU_1\, \alpha - 6}{32\, r},
\end{equation}
\begin{equation}
C_2 = \left(\frac{5\, \cU_1\, \alpha}{32} + \frac{1}{16}\right)
\frac{3\, {\cos^2\theta} - 1}{r^3} - \frac{3\, \cU_1\, \alpha - 6}{32\, r} + \frac{3\, \cU_1\, \alpha\, \left(2\, r^3\, {\sin^2\theta} + {\sin^2\theta} - 1\right)}{16\, r^4},
\end{equation}
\begin{equation}
\Psi_2 = \pars{\frac{9}{16(\sqrt{\gamma}+1)} - \frac{3}{16} \cU_1 (\cU_1 \alpha + 1)}
 \left(\frac{1}{r^2} - 1\right) \sin^2\theta \cos\theta.
\end{equation}
Note that the quadratic term does not contribute to the total force and steady-state 
velocity terms, but it does change the fluid flow, 
the electric potential and the ionic concentration.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Third-Order (cubic in $\beta$) Solution} \label{app:cubic}
Note that, due to symmetry considerations, $\cU(\beta)$ is an anti-symmetric function.
Therefore, $\cU_2 = 0$ and the next velocity term is the cubic one:
\begin{equation} \label{eq:cubic}
\cU(\beta) \approx \beta \cU_1 + \beta^3 \cU_3 + O(\beta^5).
\end{equation}

The cubic terms $\bx_3$ are computed by solving a linear PDE system 
with a right-hand side determined by the linear terms $\bx_1$ and the quadratic terms $\bx_2$.

\begin{align}
\varPhi_3 &= \frac{15\cU_1\alpha + 6 }{64}\cos\theta  - \frac{3 \cU_1\alpha}{32} {\cos}^3\theta
 + \frac{183 {\cU_1}^2\alpha^2 - 839 \cU_1\alpha - 470}{2560 r^2} \cos\theta 
\\ \nonumber &
+ \frac{3 \cos\theta \left(5 \cU_1\alpha - 6 {\cos^2\theta} - 4 \cU_1\alpha {\cos^2\theta} + 4\right)}{64 r^3} + \frac{\left(2 \cU_1\alpha - 1\right) \left(\cos\theta - 3 {\cos}^3\theta\right)}{64 r^5} 
+ {{\cos}^3\theta \left(\frac{15 \cU_1\alpha}{64} + \frac{3}{32}\right)}{r^{-2}} 
\\ \nonumber &
- \left(3 \cos\theta - 5 {\cos}^3\theta\right) \left( - \frac{19 {\cU_1}^2\alpha^2}{5120} + \frac{97 \cU_1\alpha}{5120} + \frac{3 \cU_2\alpha}{320} + \frac{21}{1280}\right){r^{-4}} 
% \\ \nonumber &
+ {{\cos}^3\theta \left(\frac{\cU_1\alpha}{64} + \frac{3}{64}\right)}{r^{-6}},
\end{align}
\begin{align}
C_3 &=
\frac{3 {{\cU_1}}^2\alpha^2 {\cos^3\theta}}{32} + \frac{\cos\theta \left(797 {{\cU_1}}^2\alpha^2 + 419 {\cU_1}\alpha - 512 {\cU_2}\alpha + 174\right)}{2560 r^2} 
- \frac{3 {\cU_1}\alpha \cos\theta \left(5 {\cU_1}\alpha + 2\right)}{64} 
\\ \nonumber &
- {\left(3 \cos\theta - 5 {\cos^3\theta}\right) \left(\frac{59 {{\cU_1}}^2\alpha^2}{5120} + \frac{103 {\cU_1}\alpha}{5120} + \frac{69 {\cU_2}\alpha}{320} + \frac{3}{1280}\right)}{r^{-4}} 
+ \frac{\alpha \left(\cos\theta - 3 {\cos^3\theta}\right) \left(5\alpha {{\cU_1}}^2 + 2 {\cU_1} + 16 {\cU_2}\right)}{128 r^5} 
\\ \nonumber &
- \frac{3\alpha \cos\theta \left( - 8\alpha {{\cU_1}}^2 {\cos^2\theta} + 7\alpha {{\cU_1}}^2 + 2 {\cU_1} + 32 {\cU_2} {\cos^2\theta} - 32 {\cU_2}\right)}{128 r^3} 
%\\ \nonumber &
+ \frac{{{\cU_1}}^2\alpha^2 {\cos^3\theta}}{32 r^6} - \frac{3 {\cU_1}\alpha {\cos^3\theta} \left(5 {\cU_1}\alpha + 2\right)}{64 r^2},
\end{align}
\begin{align}
\Psi_3 &=
r^2 {\sin^2\theta} \left(\frac{{\cW_2}}{15} - \frac{{\cW_1}}{3} + \frac{209}{3360}\right) 
 - {{\sin^2\theta} \left(\frac{5 {\cW_2}}{3} - \frac{{\cW_1}}{3} + \frac{35}{264}\right)}{r^{-1}}
 + {{\sin^4\theta} \left(2 {\cW_2} + \frac{761}{5632}\right)}{r^{-1}} 
\\ \nonumber & 
- \frac{{\sin^2\theta} \left(1848 r^6 {\sin^2\theta} - 2079 r^3 {\sin^2\theta} + 924 r^3 - 7 {\sin^2\theta} + 10\right)}{19712 r^5} 
%\\ \nonumber & 
\frac{4 {\sin^2\theta} - 5 {\sin^4\theta}}{r^3} + \left(\frac{{\cU_1}\alpha}{16} - \frac{1}{8}\right) \frac{2 r^3 - 3 r^2 + 1}{4 r} {\sin^2\theta},
\end{align}
\begin{align}
\cW_1 &= \frac{69}{512 \left(\sqrt{\gamma} + 1\right)} - \frac{1407\alpha^2 {\log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}^3}{1280} - \frac{123 \log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}{1280} - \frac{27}{512 {\left(\sqrt{\gamma} + 1\right)}^2} 
-\frac{1899\alpha {\log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}^2}{2560} 
\\ \nonumber & 
- \frac{\alpha \log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right) \left(\frac{81}{16 \left(\sqrt{\gamma} + 1\right)} - \log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right) \left(\frac{27\alpha \log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}{4} + \frac{27}{8}\right)\right)}{320} 
+ \frac{21\alpha \log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}{128 \left(\sqrt{\gamma} + 1\right)},
\end{align}
\begin{align}
\cW_2 &= \frac{9 \log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}{256} 
+ \frac{21\alpha^2 {\log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}^3 + 
15\alpha {\log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right)}^2}{64} 
- \frac{27}{512 {\left(\sqrt{\gamma} + 1\right)}^2}
%\\ \nonumber &
- \frac{297\alpha \log\left(\frac{\sqrt{\gamma} + 1}{2 \sqrt{\gamma}}\right) + 54}{1024 \left(\sqrt{\gamma} + 1\right)}.
\end{align}

The cubic solution satisfies the ${r\rightarrow\infty}$ boundary conditions, 
when $\alpha\cU_1 = 0$.

The cubic correction velocity terms (for $\alpha = 0$)
turn out to be:
\begin{equation}
\cU_3(\gamma) = \frac{31}{320(\sqrt\gamma + 1)} - \frac{9}{320(\sqrt\gamma + 1)^2} + \frac{1}{1680} - \frac{11}{160} \log \pars{\frac{1 + \gamma^{-\frac{1}{2}}}{2}}.
\end{equation}

The cubic term becomes dominant for small $\beta$ when $\gamma \approx 1$.
Note that, for $\gamma = 1$, the linear term vanishes and the cubic term 
of the velocity is $\cU(\beta) = \frac{1129}{26880}\beta^3$.

Observe that a $\cU = 0$ solution may exist for a critical $\beta_c > 0$ and $\alpha = 0$, 
if it satisfies:
\begin{equation} \label{eq:crit_beta}
\beta_c^2 = -\frac{\cU_1(\gamma)}{\cU_3(\gamma)}.
\end{equation}
Specifically, for $\gamma = 1 + \eps$, where $0 < \eps \ll 1$, $\beta_c = O\pars{\sqrt{\eps}}$:
\begin{equation}
\beta_c \approx \sqrt{-{\cU_1'(1) \eps}/{\cU_3(1)}} = 
 \sqrt{{13440 \eps}/{1129}} \approx 3.45 \sqrt{\eps}.
\end{equation}
That is, there may be a specific nonzero external field for which the particle remains at rest. The physical viability of this solution has yet to be explored.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Results} \label{sec:results}
The numerical solver is applied to the nonlinear problem of an ion-exchanger migration 
driven by an electric field \cite{yariv2010migration}
and the electrophoresis of highly charged surface inert particle 
\cite{schnitzer2012surface}. 
The solver is applied to a series of values of the electric field $\beta$, ranging 
from $\beta \ll 1$ to $\beta \sim 1$.
For each $\beta$ value, the Newton solver is initialized with the linear solution and is iterated $K$ times.
Secant method iteration is applied $M$ times to find the steady-state velocity 
by finding $\cU$ such that $F_\imath(\cU, \beta) = 0$, thus computing 
the steady-state velocity $\cU(\beta)$. 
The resulting $\cU(\beta)$ is plotted on a log-log scale, so that the asymptotic behaviour
of the solution may be examined for a wide range of $\beta$ values.
 
In order to validate the numerical solver, we employ 
the results of the asymptotic analysis of the nonlinear 
system. 
The numerical results are compared 
to the asymptotic solutions, and good correspondence is achieved.

\subsection{Ion-exchanger results}
For $\beta \ll 1$, the linear regime is dominant \eqref{eq:linear_velocity}.
When $\gamma \approx 1$, the cubic regime, where $\cU = O(\beta^3)$, 
dominates the linear one, even for weak electric fields. 
This phenomenon is confirmed both by the numerical
results and by asymptotic expansion of the nonlinear system (for $\alpha=0$).
The switch from the linear regime to the cubic regime occurs at 
an electric field value of $\beta = O(\sqrt{|\gamma - 1|})$.
The numerical results $\cU^h$, 
as well as the analytical ones \eqref{eq:cubic}, are given in Figure \ref{fig:IonExCubic}.
The numerical solver uses $N_r \times N_\theta = (400 \times 50)$, 
$R_{\max} = 10^7$,
$K = 3$, $M = 5$ and $\beta = 10^{t}$ for $t = -2:0.1:0.5$.


The linear solution for $\gamma \approx 1$, 
yields a sign change of the zeta potential $\zeta = \log (C/\gamma)$, when
$|\log\gamma| \approx 3\beta / 4$. This results in a sign change in the slip velocity,
which can be approximated for small $|\zeta| \ll 1$ as $V_\theta \approx \zeta \cdot \bnabla_S \varPhi$.
This sign change creates a vortex at the downstream end of the ion-exchanger, 
as demonstrated by the numerical solution and the asymptotic analysis results 
in Figure \ref{fig:Vortex}.

\subsection{Electrophoresis results}
In this scenario the linear regime is dominant \eqref{eq:linear_velocity}.
In order to verify the solver, the numerical steady-state velocity is compared to the
analytical solution \cite{schnitzer2012cubic}. Since the cubic correction is much smaller than
the linear solution for $\beta \ll 1$, the difference between numerical results and
the linear solution is compared to the cubic correction term. 

Since the leading order of the solution $\cU(\beta)$ is linear for $\beta \ll 1$, 
the numerical discretization error is $O(\beta)$ as well.
In order to reduce the discretization error of the numerical solution \eqref{eq:disc_zero_force}
and after verifying that the discretization error converges as $O(h^2)$,
we employ Richardson extrapolation to $\cU^h$ and $\cU^{2h}$:
\begin{equation}
\hat\cU = \frac{4}{3} \cU^h - \frac{1}{3} \cU^{2h}.
\end{equation}
The results of the extrapolation and $\hat\cU$ the analytical results 
are given at Figure \ref{fig:Electrophoresis}.
The numerical solver uses $R_{\max} = 10^2$,
$K = 3$, $M = 5$ and $\beta = 0.1 \cdot 2^{t}$ for $t = -2:0.5:5$.
The solver is applied to 2 grids of $N_r \times N_\theta = (128 \times 128)$ as the coarse grid,
and $N_r \times N_\theta = (256 \times 256)$ as the fine grid, in order to use Richardson extrapolation for $\hat\cU$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
\section{Discussion} \label{sec:discussion}
A numerical framework for solver construction for a
nonlinear electrokinetic transport system is described.
The framework is applied to two electrokinetic problems: the migration of ion-exchangers
and surface-charged inert particle electrophoresis.
The numerical results exhibit a good correspondence to the asymptotic linear model as
shown above.
Moreover, two interesting phenomena (cubic regime and downstream vortex) were predicted
using the numerical results, and were verified using asymptotic expansion of the
nonlinear system.

Future work may include replacing the full Newton step by an iterative linear solver, allowing
finer grids to be used.
Since it is expected that a boundary layer should form around the particle for $\beta \gg 1$,
a numerical solver should be able to handle large grids to achieve good numeric accuracy.
In addition, the framework may be used for automatic Newton solver construction for 
other similar nonlinear PDE systems.

\begin{figure}[htbp]
    \begin{center}
    \includegraphics[width=0.4\textwidth]{figs/Cubic/ionex_cubic1.eps}
    \includegraphics[width=0.4\textwidth]{figs/Cubic/ionex_cubic2.eps}
        \caption{Steady-state velocity $\cU$ as a function of the 
        electric field magnitude $\beta$, for $\gamma < 1$ (left) and $\gamma > 1$ (right). 
        The analytic cubic solution \eqref{eq:cubic} is represented by curves
        (solid for $\cU > 0$, dashed for $\cU < 0$), 
        and the numerical results are represented by markers 
        (circles for $\cU > 0$, squares for $\cU < 0$). Note that linear and
        cubic regimes match well the numerical results, including the critical $\beta$ 
        behaviour \eqref{eq:crit_beta}. 
        }
	    \label{fig:IonExCubic}
    \end{center}
\end{figure}

\begin{figure}[htbp]
    \begin{center}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/N_0.9000_0.1000.eps}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/A_0.9000_0.1000.eps}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/N_0.9000_0.2000.eps}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/A_0.9000_0.2000.eps}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/N_0.9000_0.4000.eps}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/A_0.9000_0.4000.eps}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/N_0.9000_0.6000.eps}
	\includegraphics[width=0.45\textwidth]{figs/Cubic/Stream/A_0.9000_0.6000.eps}
        \caption{Streamlines of the flow for various electric field $\beta$ values: 
        numerical results (left) and analytical approximation (right) for
        $\gamma = 0.9$.  The steady-state velocity $\cU$ is positive, so the
        ion-exchanger drifts to the right. 
        Note that there is a good correspondence between the numerical
        results and the analytical solution for $\beta < 1$, validating
        the vortex formation.
        }
    \label{fig:Vortex}
    \end{center}
\end{figure}

\begin{figure}[htbp]
    \begin{center}
    \includegraphics[width=0.4\textwidth]{figs/Electrophoresis/numerical_vs_analytical_alpha=0.5_Du=1.0_zeta=10.0_Rmax=100.eps}
    \includegraphics[width=0.4\textwidth]{figs/Electrophoresis/departure_from_linear_alpha=0.5_Du=1.0_zeta=10.0_Rmax=100.eps}
        \caption{Steady-state velocity $\cU$ as a function of the 
        electric field magnitude $\beta$, for highly-charged surface particle
        electrophoresis (with $\alpha = 0.5, \text{Du} = 1, \bar\zeta = 10$).
        The analytic solution velocity is represented by solid lines, 
        and the numerical results are represented by markers.
        The left figure shows the full numerical solution 
        compared to the analytical one \eqref{eq:cubic}, and
        the right figure compares the analytic cubic correction \cite{schnitzer2012cubic} 
        to the difference between the numerical results and the linear regime.
        When $\beta$ is large, the analytical cubic solution loses its validity 
        because higher-order terms become significant.}
	    \label{fig:Electrophoresis}
    \end{center}
\end{figure}

\section*{Acknowledgments}
The authors thank Prof. Ehud Yariv and Ory Schnitzer 
for introducing us to this problem, 
for the helpful discussions and valuable advice.

\appendix

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Ion-exchanger effective boundary conditions } \label{append:slip}

\subsection{Debye layer scaling}

We define the scaled coordinate $\rho$ (normal to ion-exchanger surface), where $\delta \ll 1$:
\begin{align}
  \rho = \frac{r-1}{\delta}. 
\end{align}
Thus, the electric potential and the ionic concentrations are $O(1)$ at the Debye layer ($r \approx 1$):
\begin{align}
  \varphi(\rho,\theta) &\sim \varphi, \\
  c_\pm(\rho,\theta) &\sim c_\pm, \\
  c(\rho,\theta) &\sim c, \\
  q(\rho,\theta) &\sim q.
\end{align}

The radial fluxes at the Debye layer are $O(\delta^{-1})$, due to coordinate rescaling:
\begin{align}
  j_\pm(\rho, \theta) &\sim \delta^{-1} j_\pm.
\end{align}

The pressure is $O(\delta^{-2})$, due to momentum balance equations:
\begin{align}
  p(\rho, \theta) &\sim \delta^{-2} p.
\end{align}

The tangential velocity component is $O(1)$ and the radial component is $O(\delta)$.

\subsection{Ion Fluxes}

In order to match bulk $O(1)$ outer radial ionic flux, 
the $O(\delta^{-1})$ term of the inner ionic radial flux, $j_\pm(\rho, \theta)$ must vanish:
\begin{align}
 \nonumber
  -\deriv{c_\pm}{\rho} \mp c_\pm \deriv{\varphi}{\rho} &= 0, \\
  \pars{\varPhi - \varphi} \pm\pars{\log C_\pm - \log c_\pm} &= 0, \\
 \nonumber
  \varPhi - \varphi \pm \log \frac{C_\pm}{c_\pm} &= 0.
\end{align}
This relation can be rewritten as a Boltzmann distribution of $c_\pm$,
where $\lim_{\rho\rightarrow\infty} c_\pm = C$,
\begin{equation}
c_\pm = C \exp\left[\pm(\varPhi - \varphi)\right].
\end{equation}

\subsection{Electric Potential}
The leading-order Laplace equation in the Debye layer reads
\begin{align}  
\deriv{^2 \varphi}{\rho^2} = -q = -\frac{c_+ - c_-}{2} = 
-\frac{C}{2} \pars{\exp\left[+(\varPhi - \varphi)\right] - \exp\left[-(\varPhi - \varphi)\right]} = C \sinh(\varphi - \varPhi).
\end{align}
Denote $\psi = \varphi - \varPhi$, so that $\psi(0) = \cV - \varPhi = \zeta$ and 
$\psi(\rho\rightarrow\infty) = 0$:
\begin{align}
\nonumber
\deriv{^2 \psi}{\rho^2} &= C \sinh(\psi) = 2 C \sinh{\frac{\psi}{2}}\cosh{\frac{\psi}{2}} ,
\\
2\deriv{\psi}{\rho} \deriv{^2 \psi}{\rho^2} &= 
4 C \sinh{\frac{\psi}{2}}\cosh{\frac{\psi}{2}} \deriv{\psi}{\rho} ,
\\ \nonumber
\deriv{}{\rho} \pars{\deriv{\psi}{\rho}}^2 &= 
\deriv{}{\rho} \pars{2 \sqrt{C} \sinh{\frac{\psi}{2}}}^2 .
\end{align}  

Integrating with respect to boundary condtions yields:
\begin{align}  
\nonumber
\deriv{\psi}{\rho} = -2\sqrt{C}\sinh\frac{\psi}{2} &= 
-4\sinh\frac{\psi}{4}\cosh\frac{\psi}{4} \sqrt{C} = 
-4\tanh\frac{\psi}{4}\cosh^2\frac{\psi}{4} \sqrt{C}, \\  
\frac{1/{\tanh\frac{\psi}{4}}}{4\cosh^2\frac{\psi}{4}}
\deriv{\psi}{\rho}
&= -\sqrt{C}, \\  
\nonumber
\deriv{}{\rho}\pars{\log\tanh\frac{\psi}{4}} &= \deriv{}{\rho}\pars{-\rho \sqrt{C}} .
\end{align}

Integrating with respect to boundary condtions yields:
\begin{align}
\log\tanh\frac{\psi}{4} - \log\tanh\frac{\zeta}{4} &= -\rho \sqrt{C}, \\
\psi = \varphi - \varPhi &= 
4 \tanh^{-1}\pars{\tanh{\frac{\zeta}{4}} \cdot e^{-\rho \sqrt{C}}}.
\end{align}

\subsection{Radial Momentum}
Leading-order $O(\delta^{-3})$ radial momentum balance in the Debye layer yields:
\begin{align} 
- \deriv{p}{\rho} + \deriv{\varphi}{\rho} \deriv{^2\varphi}{\rho^2} &= 0.
\end{align}
One integration yields:
\begin{align} 
p &= \frac{1}{2}\pars{\deriv{\varphi}{\rho}}^2 = \frac{1}{2}\pars{\deriv{\psi}{\rho}}^2.
\end{align}

\subsection{Tangential Momentum}
Leading-order $O(\delta^{-2})$ tangential momentum balance in the Debye layer yields:
\begin{align} 
\nonumber
0 &= \deriv{^2 v_\theta}{\rho^2} - \deriv{p}{\theta} 
 + \deriv{\varphi}{\theta} \deriv{^2\varphi}{\rho^2} ,
\\ \nonumber
\deriv{^2 v_\theta}{\rho^2} &= \frac{1}{2}\deriv{}{\theta}\pars{\deriv{\psi}{\rho}}^2
- \deriv{(\psi + \varPhi)}{\theta} \deriv{^2\psi}{\rho^2}  
 = \deriv{}{\theta}\pars{2C \sinh^2\frac{\psi}{2}}
- \deriv{\psi}{\theta} C \sinh\psi
- \deriv{\varPhi}{\theta} \deriv{^2\psi}{\rho^2}  
\\
 &= \deriv{}{\theta}\pars{C \pars{\cosh\psi - 1}}
- C \sinh\psi \deriv{\psi}{\theta}
- \deriv{\varPhi}{\theta} \deriv{^2\psi}{\rho^2}  
\\ \nonumber
 &= \deriv{C}{\theta} \pars{\cosh\psi - 1}
- \deriv{\varPhi}{\theta} \deriv{^2\psi}{\rho^2}  
 = \deriv{C}{\theta} \pars{2 \sinh^2 \frac{\psi}{2}}
- \deriv{\varPhi}{\theta} \deriv{^2\psi}{\rho^2}  
\\ \nonumber
 &= -\deriv{C}{\theta} \frac{2}{\sqrt{C}} \pars{\half \sinh \frac{\psi}{2} \deriv{\psi}{\rho}}
- \deriv{\varPhi}{\theta} \deriv{^2\psi}{\rho^2}  
 = -\deriv{C}{\theta} \frac{2}{\sqrt{C}} \deriv{}{\rho}\pars{\cosh \frac{\psi}{2}}
- \deriv{\varPhi}{\theta} \deriv{^2\psi}{\rho^2}  .
\end{align}
By integrating from specific $\rho$ to $\rho \rightarrow \infty$ (where $\psi = 0$):
\begin{align}
\deriv{v_\theta}{\rho} &= -\deriv{C}{\theta} \frac{2}{\sqrt{C}} 
\pars{\cosh \frac{\psi}{2} - 1} - \deriv{\varPhi}{\theta} \deriv{\psi}{\rho}   
= -\deriv{C}{\theta} \frac{4}{\sqrt{C}} \sinh^2 \frac{\psi}{4} 
  - \deriv{\varPhi}{\theta} \deriv{\psi}{\rho}   .
\end{align}
Note that:
\begin{align}
\deriv{\psi}{\rho} &= -2\sqrt{C}\sinh\frac{\psi}{2} = 
                       -4\sqrt{C}\sinh\frac{\psi}{4}\cosh\frac{\psi}{4},
\\
-4\sinh\frac{\psi}{4} &= \frac{1 / \cosh\frac{\psi}{4}}{\sqrt{C}} \deriv{\psi}{\rho}.
\end{align}
Thus:
\begin{align}
\deriv{v_\theta}{\rho} &= 
  \pars{\deriv{C}{\theta} \frac{1}{C}} \cdot
  \pars{\frac{\sinh\frac{\psi}{4}}{\cosh\frac{\psi}{4}} \deriv{\psi}{\rho}}
  - \deriv{\varPhi}{\theta} \deriv{\psi}{\rho}
=  4\deriv{}{\rho} \pars{\log\cosh\frac{\psi}{4}} \deriv{}{\theta} \log C
  - \deriv{\psi}{\rho} \deriv{\varPhi}{\theta},
\\
\deriv{v_\theta}{\rho} &= 
\deriv{}{\rho} \pars{ 4\log\cosh\frac{\psi}{4} \deriv{}{\theta} \log C
  - \psi \deriv{\varPhi}{\theta} }.
\end{align}

By integrating from $\rho = 0$ to $\rho \rightarrow \infty$, 
we have Dukhin-Derjaguin slip formula for tangential velocity component $V_\theta$ 
(where the radial component is $V_r = 0$) for $\zeta = \cV - \varPhi$:
\begin{align} 
V_\theta = \zeta \cdot \deriv{\varPhi}{\theta} -
      4\log\cosh \frac{\zeta}{4} \cdot \deriv{}{\theta} \log C 
= \zeta \cdot \deriv{\varPhi}{\theta} + 
      2\log\pars{1 - \tanh^2 \frac{\zeta}{4}} \cdot \deriv{}{\theta} \log C .
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Differential operators in spherical coordinates} \label{append:spherical}

The following spherical coordinate system is used:
\begin{align}
\nonumber
x &= r \sin \theta \cos \phi \\
y &= r \sin \theta \sin \phi \\
\nonumber
z &= r \cos \theta
\end{align}

Assume full symmetry around $z$ axis -- there is no dependence on $\phi$:
\begin{align}
\bnabla f &= \frac{\partial f}{\partial r} \mathbf{\hat{r}} +
\frac{1}{r} \frac{\partial f}{\partial \theta} \mathbf{\hat{\theta}} +
\frac{1}{r \sin\theta} \frac{\partial f}{\partial \phi} \mathbf{\hat{\phi}}
\\
\bnabla \mathbf{\cdot} \mathbf{F} &= 
\frac{1}{r^2}\frac{\partial}{\partial r} \left( r^2 \cdot F_r\right)
  + \frac{1}{r \sin\theta} \frac{\partial}{\partial \theta} \left( \sin\theta \cdot F_\theta\right)
  + \frac{1}{r \sin\theta} \frac{\partial F_\phi}{\partial \phi}
\end{align}

\subsection{Scalar Operators}
Scalar Laplacian derivation:
\begin{align}
\Laplacian f = \bnabla \mathbf{\cdot} \bnabla f = \frac{1}{r^2}\frac{\partial}{\partial r}
\left( r^2 \frac{\partial f}{\partial r} \right) +
\frac{1}{r^2 \sin\theta} \frac{\partial}{\partial \theta} \left( \sin\theta \cdot \frac{\partial f}{\partial \theta}\right)
+ \frac{1}{r^2 \sin^2\theta} \frac{\partial^2 f}{\partial \phi^2}
\end{align}
In conservative form:
\begin{align}
r^2 \sin\theta \cdot \bLaplacian f = \frac{\partial}{\partial r} \left( r^2 \sin \theta \frac{\partial f}{\partial r} \right) +
\frac{\partial}{\partial \theta} \left( \sin\theta \cdot \frac{\partial f}{\partial \theta}\right) +
\frac{\partial}{\partial \phi} \left( \frac{1}{\sin\theta} \cdot \frac{\partial f}{\partial \phi}\right)
\end{align}

The unit vectors in spherical coordinate system are:
\begin{align}
 \brhat &= \deriv{\br}{r}
 = \mat{c}{\sin\theta \cos\phi \\ \sin\theta \sin\phi \\ \cos\theta} ,&
 \bthetahat &= \frac{1}{r} \deriv{\br}{\theta}
 = \mat{c}{\cos\theta \cos\phi \\ \cos\theta \sin\phi \\ -\sin\theta} ,&
 \bphihat &= \frac{1}{r \sin \theta} \deriv{\br}{\phi}
 = \mat{c}{-\sin\phi \\ \cos\phi \\ 0}
\end{align}
Note that:
\begin{align}
  \deriv{\brhat}{r} = \mathbf{0} , \nonumber
  \deriv{\bthetahat}{r} = \mathbf{0} , 
  \deriv{\bphihat}{r} = \mathbf{0}, \\
  \deriv{\brhat}{\theta} = \bthetahat , 
  \deriv{\bthetahat}{\theta} = -\brhat , 
  \deriv{\bphihat}{\theta} = \mathbf{0}, \\
  \deriv{\brhat}{\phi} = \sin \theta \cdot \bphihat , \nonumber
  \deriv{\bthetahat}{\phi} = \cos \theta \cdot \bphihat , 
  \deriv{\bphihat}{\phi} = -\sin \theta \cdot \brhat -\cos \theta \cdot \bthetahat.
\end{align}

\subsection{Vector Operators}
Vector gradient operator can be written by:
\begin{align} \nonumber
\bnabla\bV &= \left\{ \brhat \deriv{}{r} +
\bthetahat \frac{1}{r} \deriv{}{\theta} +
\bphihat \frac{1}{r \sin\theta} \deriv{}{\phi} \right\}
\bV = \left\{ \brhat \deriv{}{r} +
\bthetahat \frac{1}{r} \deriv{}{\theta} +
\bphihat \frac{1}{r \sin\theta} \deriv{}{\phi} \right\}
\left( V_r \brhat + V_\theta \bthetahat + V_\phi \bphihat \right)
\\ \nonumber
\deriv{\bV}{r} &=
\deriv{V_r}{r}\brhat + \deriv{V_\theta}{r}\bthetahat + \deriv{V_\phi}{r}\bphihat
\\ 
\deriv{\bV}{\theta} &=
\deriv{V_r}{\theta}\brhat + \deriv{V_\theta}{\theta}\bthetahat + \deriv{V_\phi}{\theta}\bphihat
+ V_r\bthetahat - V_\theta\brhat
\\ \nonumber
\deriv{\bV}{\phi} &=
\deriv{V_r}{\phi}\brhat + \deriv{V_\theta}{\phi}\bthetahat + \deriv{V_\phi}{\phi}\bphihat
+ V_r \sin\theta\bphihat + V_\theta \cos\theta\bphihat -
V_\phi \left(\brhat \sin\theta + \bthetahat \cos\theta \right)
\\ \nonumber
\bnabla\bV &=
\mat{ccc}{1&0&0 \\ 0&\frac{1}{r}&0 \\ 0&0&\frac{1}{r \sin\theta}}
\mat{ccc}{
\deriv{V_r}{r} & \deriv{V_\theta}{r} & \deriv{V_\phi}{r} \\
\deriv{V_r}{\theta} - V_\theta &
\deriv{V_\theta}{\theta} + V_r&
\deriv{V_\phi}{\theta} \\
\deriv{V_r}{\phi} - V_\phi \sin\theta &
\deriv{V_\theta}{\phi} - V_\phi \cos\theta  &
\deriv{V_\phi}{\phi} + V_r \sin\theta + V_\theta \cos\theta
}
\end{align}
Vector Laplacian components can be written as:
\begin{align}
\Laplacian \bV = \bnabla \cdot \bnabla \bV &= \frac{1}{r^2}\deriv{}{r}\left(r^2 \deriv{\bV}{r}\right) +
\frac{1}{r^2\sin\theta}\deriv{}{\theta}\left(\sin\theta\deriv{\bV}{\theta}\right)+
\frac{1}{r^2 \sin^2\theta}\deriv{}{\phi}\left(\deriv{\bV}{\phi}\right)
\end{align}
$\brhat$ component:
\begin{align}
\Laplacian (V_r\brhat) &= \nonumber
\frac{1}{r^2}\deriv{}{r}\left(r^2 \deriv{V_r}{r}\right)\brhat
\\ &+ \nonumber
\frac{1}{r^2\sin\theta}\deriv{}{\theta}\left(
\sin\theta\left(\deriv{V_r}{\theta}\brhat + V_r\bthetahat \right)\right)
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\deriv{}{\phi}\left(
\deriv{V_r}{\phi}\brhat + V_r \sin\theta\bphihat
\right) \\
\Laplacian (V_r\brhat) &= 
\left(
\frac{2}{r}\deriv{V_r}{r}+\deriv{^2V_r}{r^2}\right)\brhat
\\ &+ \nonumber
\frac{1}{r^2\sin\theta}\left(
\cos\theta\left(\deriv{V_r}{\theta}\brhat + V_r\bthetahat \right) +
\sin\theta\left(\deriv{^2V_r}{\theta^2}\brhat + \deriv{V_r}{\theta}\bthetahat + \deriv{V_r}{\theta}\bthetahat - V_r\brhat\right)
\right)
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\left(
\deriv{^2V_r}{\phi^2}\brhat + \deriv{V_r}{\phi} \sin\theta\bphihat +
\deriv{V_r}{\phi}\bphihat\sin\theta - V_r \sin\theta
\left(\brhat \sin\theta + \bthetahat \cos\theta \right)
\right)
\\ \nonumber
\Laplacian (V_r\brhat) &=
\left(
\frac{2}{r}\deriv{V_r}{r}+\deriv{^2V_r}{r^2}-\frac{2V_r}{r^2}
+ \frac{1}{r^2}\deriv{^2V_r}{\theta^2}
+ \frac{\cot\theta}{r^2} \deriv{V_r}{\theta}
+ \frac{1}{r^2 \sin^2\theta} \deriv{^2V_r}{\phi^2}
\right)\brhat
\\ &+ \frac{2}{r^2} \deriv{V_r}{\theta} \bthetahat + \frac{2}{r^2 \sin\theta}\deriv{V_r}{\phi} \bphihat
\nonumber
\end{align}
$\bthetahat$ component:
\begin{align}
\Laplacian (V_\theta\bthetahat) &= \nonumber
\frac{1}{r^2}\deriv{}{r}\left(r^2 \deriv{V_\theta}{r}\right)\bthetahat
\\ &+ \nonumber
\frac{1}{r^2\sin\theta}\deriv{}{\theta}\left(
\sin\theta\left(\deriv{V_\theta}{\theta}\bthetahat - V_\theta\brhat \right)\right)
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\deriv{}{\phi}\left(
\deriv{V_\theta}{\phi}\bthetahat + V_\theta \cos\theta\bphihat
\right)
\\ 
\Laplacian (V_\theta\bthetahat) &=
\left(\frac{2}{r}\deriv{V_\theta}{r} + \deriv{^2V_\theta}{r^2}\right)\bthetahat
\\ &+ \nonumber
\frac{1}{r^2\sin\theta}\left(
\cos\theta\left(\deriv{V_\theta}{\theta}\bthetahat - V_\theta\brhat \right) +
\sin\theta\left(\deriv{^2V_\theta}{\theta^2}\bthetahat - \deriv{V_\theta}{\theta}\brhat
-\deriv{V_\theta}{\theta}\brhat - V_\theta\bthetahat\right)
\right)
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\left(
\deriv{^2V_\theta}{\phi^2}\bthetahat + \deriv{V_\theta}{\phi} \cos\theta\bphihat +
\deriv{V_\theta}{\phi}\cos\theta\bphihat
- V_\theta \cos\theta \left(\brhat \sin\theta + \bthetahat \cos\theta \right)
\right)
\\ \nonumber
\Laplacian (V_\theta\bthetahat) &=
\left(-\frac{2\cot\theta}{r^2}V_\theta - 2\deriv{V_\theta}{\theta}\right)\brhat +
\left(\frac{2}{r}\deriv{V_\theta}{r} + \deriv{^2V_\theta}{r^2} +
\frac{\cot\theta}{r^2} \deriv{V_\theta}{\theta} +
\frac{1}{r^2}\deriv{^2V_\theta}{\theta^2}\right)\bthetahat
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\left(
\deriv{^2V_\theta}{\phi^2} - V_\theta \right)\bthetahat
+ \frac{2 \cot\theta}{r^2 \sin\theta} \deriv{V_\theta}{\phi} \bphihat
\end{align}
$\bphihat$ component:
\begin{align} \nonumber
\Laplacian (V_\phi\bphihat) &= \nonumber
\frac{1}{r^2}\deriv{}{r}\left(r^2 \deriv{V_\phi}{r}\right)\bphihat +
\frac{1}{r^2\sin\theta}\deriv{}{\theta}\left(
\sin\theta \deriv{V_\phi}{\theta}\bphihat \right)
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\deriv{}{\phi}\left(
\deriv{V_\phi}{\phi}\bphihat
- V_\phi \left(\brhat \sin\theta + \bthetahat \cos\theta\right)
\right)
\\ 
\Laplacian (V_\phi\bphihat) &=
\frac{1}{r^2}\deriv{}{r}\left(r^2 \deriv{V_\phi}{r}\right)\bphihat +
\frac{1}{r^2\sin\theta}\deriv{}{\theta}\left(
\sin\theta \deriv{V_\phi}{\theta}\bphihat \right)
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\deriv{}{\phi}\left(
\deriv{V_\phi}{\phi}\bphihat
- V_\phi \left(\brhat \sin\theta + \bthetahat \cos\theta\right)
\right)
\\ \nonumber
\Laplacian (V_\phi\bphihat) &=
\left(\frac{2}{r} \deriv{V_\phi}{r} + \deriv{^2V_\phi}{r^2}\right)\bphihat
+
\frac{1}{r^2\sin\theta}\left(
\cos\theta \deriv{V_\phi}{\theta} +
\sin\theta \deriv{^2V_\phi}{\theta^2}
\right)\bphihat
\\ &+ \nonumber
\frac{1}{r^2 \sin^2\theta}\left(
\deriv{^2V_\phi}{\phi^2}\bphihat
- 2 \deriv{V_\phi}{\phi} \left(\brhat \sin\theta + \bthetahat \cos\theta\right)
- V_\phi \bphihat
\right)
\end{align}
In summary:
\begin{align} \nonumber
\Laplacian \bV &= \left(\Laplacian V_r - \frac{2V_r}{r^2}\right)\brhat
+ \frac{2}{r^2}\deriv{V_r}{\theta} \bthetahat + \frac{2}{r^2 \sin\theta}\deriv{V_r}{\phi} \bphihat \\
&-
\frac{2}{r^2 \sin\theta} \deriv{\left(V_\theta \sin\theta \right)}{\theta}\brhat
+ \left(\Laplacian V_\theta - \frac{V_\theta}{r^2 \sin^2\theta}\right) \bthetahat
+ \frac{2 \cot\theta}{r^2 \sin\theta} \deriv{V_\theta}{\phi} \bphihat \\
&- \nonumber
\frac{2}{r^2 \sin\theta}\deriv{V_\phi}{\phi}\brhat -
\frac{2 \cot\theta}{r^2 \sin\theta}\deriv{V_\phi}{\phi}\bthetahat
+ \left(\Laplacian V_\phi - \frac{V_\phi}{r^2 \sin^2\theta}\right)\bphihat
\end{align}

Since $V_\phi = 0$ and $\deriv{}{\phi}(\cdot) = 0$, we get:
\begin{align} \nonumber
\Laplacian \bV &= \left(\Laplacian V_r - \frac{2V_r}{r^2} - \frac{2}{r^2 \sin\theta} \deriv{\left(V_\theta \sin\theta \right)}{\theta}\right)\brhat
+
\left(\Laplacian V_\theta - \frac{V_\theta}{r^2 \sin^2\theta} + \frac{2}{r^2}\deriv{V_r}{\theta}\right) \bthetahat
\\
\Laplacian \bV &= \left(
\frac{1}{r^2}\deriv{}{r}\left( r^2 \deriv{V_r}{r} \right) + \frac{1}{r^2 \sin\theta} \deriv{}{\theta} \left( \sin\theta \cdot \deriv{V_r}{\theta}\right)
 - \frac{2V_r}{r^2} - \frac{2}{r^2 \sin\theta} \deriv{\left(V_\theta \sin\theta \right)}{\theta}\right)\brhat \\ \nonumber
&+ \left(
\frac{1}{r^2}\deriv{}{r}\left( r^2 \deriv{V_\theta}{r} \right) + \frac{1}{r^2 \sin\theta} \deriv{}{\theta} \left( \sin\theta \cdot \deriv{V_\theta}{\theta}\right)
 - \frac{V_\theta}{r^2 \sin^2\theta} + \frac{2}{r^2}\deriv{V_r}{\theta}\right) \bthetahat
\end{align}

\bibliographystyle{unsrt}
\bibliography{ijnam}

\end{document}
